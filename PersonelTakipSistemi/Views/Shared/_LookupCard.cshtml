@model dynamic
@{
    var items = Model.Items as IEnumerable<dynamic>;
    string type = Model.Type;
    string title = Model.Title;
}

<div class="card h-100">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">@title</h5>
        <button class="btn btn-sm btn-primary" onclick="openAddModal('@type', '@title')">
            <i class="bx bx-plus"></i> Ekle
        </button>
    </div>
    <div class="card-body" style="max-height: 300px; overflow-y: auto;">
        @if (items != null && items.Any())
        {
            <ul class="list-group list-group-flush">
                @foreach (var item in items)
                {
                    var props = item.GetType().GetProperties();
                    var idProp = ((System.Reflection.PropertyInfo[])props).FirstOrDefault(p => p.Name.EndsWith("Id") && p.Name != "PersonelId");
                    var idVal = idProp != null ? idProp.GetValue(item) : 0;
                    var adVal = item.Ad;

                    <li class="list-group-item px-0 py-2" id="row-@type-@idVal">
                        <!-- Normal View -->
                        <div class="d-flex justify-content-between align-items-center view-mode">
                            <span class="item-text">@adVal</span>
                            <div class="d-flex gap-1">
                                <span role="button" class="text-primary" onclick="startEdit('@type', @idVal, this)" title="Düzenle" style="font-size:1.25rem;line-height:1;cursor:pointer;">
                                    <i class="bx bx-edit-alt fw-bold"></i>
                                </span>
                                <span role="button" class="text-danger" onclick="deleteItem('@type', @idVal)" title="Sil" style="font-size:1.25rem;line-height:1;cursor:pointer;">
                                    <i class="bx bx-trash fw-bold"></i>
                                </span>
                            </div>
                        </div>
                        <!-- Edit View (hidden by default) -->
                        <div class="edit-mode" style="display:none;">
                            <div class="d-flex align-items-center gap-1">
                                <input type="text" class="form-control form-control-sm edit-input" value="@adVal" style="flex:1;" />
                                <span role="button" class="text-success" onclick="saveEdit('@type', @idVal, this)" title="Kaydet" style="font-size:1.4rem;line-height:1;cursor:pointer;">
                                    <i class="bx bx-check fw-bold"></i>
                                </span>
                                <span role="button" class="text-secondary" onclick="cancelEdit(this)" title="İptal" style="font-size:1.4rem;line-height:1;cursor:pointer;">
                                    <i class="bx bx-x fw-bold"></i>
                                </span>
                            </div>
                        </div>
                    </li>
                }
            </ul>
        }
        else
        {
            <p class="text-muted small text-center my-4">Kayıt bulunamadı.</p>
        }
    </div>
</div>
